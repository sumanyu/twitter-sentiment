// Generated by CoffeeScript 1.6.2
(function() {
  var TwitterSentimentGraph;

  TwitterSentimentGraph = (function() {
    function TwitterSentimentGraph(element) {
      this.element = element;
      this._setup();
    }

    TwitterSentimentGraph.prototype._setup = function() {
      this.width = 800;
      this.height = 400;
      return this.data = [];
    };

    TwitterSentimentGraph.prototype._populateFakeData = function() {
      var i, tmp, _i, _results;

      _results = [];
      for (i = _i = 0; _i <= 30; i = ++_i) {
        tmp = {
          x: (new Date).getTime() + i * 50,
          y: Math.floor(Math.random() * 7) - 3
        };
        _results.push(this.data.push(tmp));
      }
      return _results;
    };

    TwitterSentimentGraph.prototype._rickShawData = function() {
      var i, _i, _results;

      this.random = new Rickshaw.Fixtures.RandomData(100);
      _results = [];
      for (i = _i = 0; _i <= 100; i = ++_i) {
        _results.push(this.random.addData([this.data]));
      }
      return _results;
    };

    TwitterSentimentGraph.prototype._sampleData = function() {
      var i, tmp, _i, _results;

      _results = [];
      for (i = _i = 0; _i <= 30; i = ++_i) {
        tmp = {
          x: i,
          y: Math.floor(Math.random() * 6) - 3
        };
        _results.push(this.data.push(tmp));
      }
      return _results;
    };

    TwitterSentimentGraph.prototype._setData = function() {
      return this._rickShawData();
    };

    TwitterSentimentGraph.prototype._setAxis = function() {
      var config, ticksTreatment;

      ticksTreatment = 'glow';
      this.xAxis = new Rickshaw.Graph.Axis.Time({
        graph: this.graph,
        ticksTreatment: ticksTreatment
      });
      config = {
        graph: this.graph,
        orientation: 'left',
        tickFormat: Rickshaw.Fixtures.Number.formatKMBT,
        element: $('#y_axis')[0],
        ticksTreatment: ticksTreatment
      };
      return this.yAxis = new Rickshaw.Graph.Axis.Y(config);
    };

    TwitterSentimentGraph.prototype._setLegend = function() {
      var config;

      config = {
        element: $("#legend")[0],
        graph: this.graph
      };
      return this.legend = Rickshaw.Graph.Legend(config);
    };

    TwitterSentimentGraph.prototype._setSlider = function() {
      var config;

      config = {
        graph: this.graph,
        element: $("#slider")
      };
      return this.slider = new Rickshaw.Graph.RangeSlider(config);
    };

    TwitterSentimentGraph.prototype._setHoverDetail = function() {
      return this.hoverDetail = new Rickshaw.Graph.HoverDetail({
        graph: this.graph
      });
    };

    TwitterSentimentGraph.prototype._scheduleUpdateData = function() {
      var fetch_data,
        _this = this;

      fetch_data = function() {
        _this.random.addData([_this.data]);
        return _this.graph.update();
      };
      return setInterval(fetch_data, 1000);
    };

    TwitterSentimentGraph.prototype.drawGraph = function() {
      var construction;

      this._setData();
      construction = {
        element: this.element,
        height: this.height,
        width: this.width,
        min: 'auto',
        stroke: true,
        preserve: true,
        series: [
          {
            color: 'steelblue',
            name: 'Global',
            data: this.data
          }
        ]
      };
      this.graph = new Rickshaw.Graph(construction);
      this._setAxis();
      this._setSlider();
      this._setHoverDetail();
      this._scheduleUpdateData();
      return this.graph.render();
    };

    return TwitterSentimentGraph;

  })();

  $(document).ready(function() {
    var twitter_sentiment_graph;

    twitter_sentiment_graph = new TwitterSentimentGraph($("#graph")[0]);
    return twitter_sentiment_graph.drawGraph();
  });

}).call(this);
